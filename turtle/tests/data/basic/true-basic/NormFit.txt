!
!
!  NORMFIT. Show goodness-of-fit against normal distribution.
!
LIBRARY "Stat2Lib.trc"

DIM x(0), y(0), r(0), fr(0,0)

CALL SimNormal (300, 20, 4, x)    ! Normal distribution
CALL SimPoisson (300, 20, y)      ! Poisson distribution

LET f = 10                        ! From,to,step...
LET t = 40                        ! ...for histograms
LET s = 1
CALL SetNormal (1)                ! Add normal curve
CALL SetHist ("rel")              ! Use relative plots

OPEN #1: screen 0, .49, .5, 1     ! Hist of normal dist.
CALL SetTitle ("Normal")
CALL PlotHist (x, f, t, 1, "")

OPEN #2: screen .5, 1, .5, 1      ! Hist of Poisson dist.
CALL SetTitle ("Poisson")
CALL PlotHist (y, f, t, 1, "")

CALL SetTitle ("")

OPEN #3: screen 0, .49, 0, .49    ! Normal minus residue
CALL SetYscale (-1, 1)
CALL PlotNormFit (x, f, t, 1, 10, 0, "")

OPEN #4: screen .5, 1, 0, .49     ! Poisson minus residue
CALL PlotNormFit (y, f, t, 1, 10, 0, "")

END
