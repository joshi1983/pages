!
!  STAT3D.  Draw a contingency table in a perspective view.
!  This requires the Statistics and 3-D Graphics Toolkits.
!

! The sources for 3dCont and 3dLib are in the 3DGrafTK folder

LIBRARY "3DCont.trc", "3DLib.trc", "Stat1Lib.trc"

DIM t(5,5), e(0,0), rs(0), cs(0), z(5)

MAT READ t                        ! Contingency table
DATA 0,1,0,1,0
DATA 0,1,1,2,0
DATA 1,2,1,2,1
DATA 1,3,2,3,1
DATA 1,2,1,1,0

OPEN #1: screen 0, 1, .2, 1       ! Graphics window

CALL ContTable (t, ch2, df, p, v, cc, ccc, ca, e, rs, cs, gs)

CALL AppendRow (t, z)             ! Add column sums...
CALL AppendRow (t, z)
CALL AppendRow (t, cs)
CALL AppendRow (t, cs)
MAT redim rs(1:Size(rs)+4)        ! ...and row sums
MAT redim z(Size(z)+4)
CALL AppendCol (t, z)
CALL AppendCol (t, z)
CALL AppendCol (t, rs)

CALL ScalePersWindow (1, 3.5, .5, 3, 0, 10)
CALL SetCamera3 (-35, -35, 150)
CALL AskDistance3 (d)
CALL SetDistance3 (d/3)           ! Move in a little...

CALL SetColor3 ("background [0] 1")    ! Color bar tops according to height
CALL SetBarColor3 ("yellow", "red", "")
CALL ZbarData (t, 0, 3, 0, 3)     ! Draw bars

OPEN #2: screen 0, 1, 0, .18
PRINT "   -- 5x5 Contingency Table Analysis --"
PRINT using "Chi square #.###   Contingency coeff #.###": ch2, cc
PRINT using "DF ##              Probability       #.###": df, p;

END
