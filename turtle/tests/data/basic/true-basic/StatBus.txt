!
!  STATBUS.  Show scatter plot with text of two datasets,
!  then overlapped histogram below with separation distances.
!
! The source for BGLib is in the BusGraTK folder
LIBRARY "BGLib.trc","Stat2Lib.trc"

DIM x(15), y(15), mark$(15), d1(105), d2(105), dist(0,0), legends$(2)

CALL SetXscale (10, 90)
CALL SetYscale (10, 90)

!  Show scatter plot with text.
!
OPEN #1: screen 0, 1, .5, 1
MAT READ x, y
MAT mark$ = "T"
CALL ScatterMark (x, y, mark$, "")

MAT READ x, y
MAT mark$ = "Zn"
CALL SetOverlay (1)
CALL ScatterMark (x, y, mark$, "")

!  Show histograms of separation distances.
!
RESTORE
MAT READ x, y
CALL GetDistances (x, y, d1)

MAT READ x, y
CALL GetDistances (x, y, d2)

OPEN #2: screen 0, 1, 0, .49
CALL SetTitle ("Separation Distances")
CALL AppendRow (dist, d1)
CALL AppendRow (dist, d2)
LET legends$(1) = "T"
LET legends$(2) = "Zn"
CALL SetBarType ("over")          ! Use overlapped bars
CALL MultiHist(dist, legends$, "black black red yellow")


DATA 17.73, 41.76, 47.49, 51.55, 73.04, 65.40, 58.48, 55.85, 74.00, 86.87, 82.12
DATA 64.69, 73.28, 36.51, 29.34
DATA 61.87, 56.70, 48.47, 40.62, 41.39, 57.46, 53.25, 76.22, 83.88, 72.39, 60.14
DATA 49.04, 44.26, 76.79, 23.97
DATA 35.79, 35.31, 42.72, 40.57, 36.03, 31.25, 23.61, 23.85, 16.45, 29.58, 49.40
DATA 57.52, 53.46, 41.04, 19.31
DATA 63.01, 67.22, 63.78, 62.06, 62.25, 65.50, 60.53, 56.89, 70.48, 81.20, 76.60
DATA 79.28, 63.21, 49.81, 40.05

END

!  Get all separation distances between x/y points
!  into d() -- counting pairs only once.  Don't count self-to-self.
!
SUB GetDistances (x(), y(), d())


    FOR i = 1 to Size(x)-1
        FOR j = i+1 to Size(y)
            LET k = k+1
            LET d(k) = Sqr((x(i)-x(j))^2+(y(i)-y(j))^2)

        NEXT j

    NEXT i

END SUB
